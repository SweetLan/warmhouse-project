# Project_WarmHouse

# Задание 1. Анализ и планирование

> **Примечание:**  
> Информация AS IS архитектуры есть по [ссылке](https://practicum.yandex.ru/learn/software-architect/courses/958ef1df-e5b3-4055-b01e-540e479ca32f/sprints/590586/topics/db087061-1ee4-4a8b-8605-833f43ddd232/lessons/4123eb01-bcb0-4529-aa20-8c02223f1b4c/)

### 1. Описание функциональности монолитного приложения

**Управление отоплением:**

- Пользователи могут удалённо включать и выключать отопление в своих домах через веб-интерфейс.
- Система поддерживает управление отоплением только при наличии установленных фирменных датчиков и реле.
- Управление осуществляется по команде от сервера к устройству напрямую.
- Установка оборудования требует выезда специалиста.
- Пользователь не может самостоятельно подключить оборудование к системе.

**Мониторинг температуры:**

- Система получает данные о текущей температуре с датчиков, установленных в домах пользователей.
- Пользователи могут просматривать температуру в режиме реального времени через веб-интерфейс.
- Запрос на получение температуры инициируется сервером (pull-модель).
- Данные обновляются синхронно и доступны только после получения ответа от датчика.

### 2. Анализ архитектуры монолитного приложения

- **Язык программирования:** Go
- **СУБД:** PostgreSQL
- **Архитектурный стиль:** Монолит
- **Организация компонентов:**  
  Вся бизнес-логика, обработка HTTP-запросов, работа с базой данных и взаимодействие с устройствами находятся в рамках одного исполняемого приложения.
- **Взаимодействие компонентов:**  
  Синхронное — все операции выполняются последовательно, без использования очередей или событийной модели.
- **Коммуникация с устройствами:**  
  Сервер отправляет команды и запрашивает данные напрямую у устройств. Отсутствует двусторонняя или асинхронная связь.
- **Масштабируемость:**  
  Ограничена — невозможно масштабировать отдельные части системы. Любые изменения требуют изменения и повторного развертывания всего приложения.
- **Развёртывание:**  
  Обновление или масштабирование приложения требует полной остановки текущего инстанса.
- **Установка оборудования:**  
  Выполняется вручную специалистами компании, с физическим выездом к пользователю.

### 3. Определение доменов и границы контекстов

| Домен                | Описание                                                         |
|----------------------|------------------------------------------------------------------|
| Управление отоплением| Включение/выключение отопления                                    |
| Мониторинг температуры  | Получение температуры с датчиков и отображение пользователям        |
| Подключение оборудования | Установка и подключение устройств специалистом                    |
| Аутентификация пользователей | Вход в систему                              |


### **4. Проблемы монолитного решения**
Монолитная архитектура текущей системы компании «Тёплый дом» создаёт ряд ограничений и рисков, особенно в условиях необходимости масштабирования и добавления новых функций:

#### Высокий риск ошибок
- Изменения в одной части кода (например, управление отоплением) могут непредсказуемо повлиять на другие (например, мониторинг температуры).
- Отсутствие изоляции между компонентами приводит к необходимости комплексного тестирования всей системы даже при незначительных изменениях.
- Это замедляет разработку и повышает расходы на QA.

#### Длительные циклы разработки и развёртывания
- Любое обновление требует пересборки и перезапуска всего приложения.
- Добавление новых функций (например, управление освещением или безопасностью) становится затруднительным и медленным.
- Развёртывание обновлений требует остановки всей системы, что критично при масштабировании.

#### Сложности в командной разработке
- При росте команды и проекта разные специалисты начинают вмешиваться в общую кодовую базу.
- Это увеличивает количество конфликтов, слияний и снижает эффективность параллельной работы.
- Команды не могут работать независимо — требуется постоянная синхронизация.

#### Ограниченная масштабируемость
- Отдельные части системы не могут масштабироваться изолированно.
- Например, если нагрузка растёт на компоненте мониторинга температуры, необходимо масштабировать всё приложение целиком.
- Это ведёт к неэффективному расходованию ресурсов и снижает отказоустойчивость.


### 5. Визуализация контекста системы — диаграмма С4

[Контекстная диаграмма AS IS монолитного решения](architecture/context)


# Задание 2. Проектирование микросервисной архитектуры


**Диаграмма контейнеров (Containers)**

[Диаграмма контейнеров TO BE решения](architecture/container)


**Диаграмма компонентов (Components)**

[Диаграмма компонентов сервиса управления устройствами](architecture/component)

**Диаграмма кода (Code)**

[Диаграмма кода управления устройствами умного дома ](architecture/code)

# Задание 3. Разработка ER-диаграммы

[Контекстная диаграмма AS IS монолитного решения](architecture/er)

# Задание 4. Создание и документирование API

### 1. Тип API

Ипользуем **REST API** как основной способ взаимодействия между микросервисами, потому что: 

- **Простота и совместимость**  
  REST работает поверх HTTP и легко интегрируется с любыми клиентами (браузеры, сервисы, мобильные приложения и другие микросервисы).

- **Синхронный запрос/ответ**  
  Для задач управления устройствами (включить/выключить, получить статус) важно сразу получить результат действия — REST идеально подходит для этого паттерна.

- **Поддержка Swagger/OpenAPI**  
  REST API легко документировать через OpenAPI, что мы уже сделали в swagger.yml. Это упрощает разработку и тестирование.

- **Унификация протокола обмена**  
  Все микросервисы взаимодействуют по единому стандарту JSON over HTTP, что упрощает маршрутизацию через API Gateway.

### 2. Документация API


[swagger-ui](swagger.yaml)


# Задание 5. Работа с docker и docker-compose

Проверены методы

- Create Sensor - работает
- Get All Sensors - работает

http://localhost:8081/temperature?location=Living%20Room - работает



